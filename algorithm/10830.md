---
id: "10830"
aliases: []
tags: []
---

ğŸ’³ ë¬¸ì œì´í•´

N * N í–‰ë ¬(matrix)ê°€ ì£¼ì–´ì¡Œì„ ë•Œ, bë§Œí¼ ê³±í•´ì£¼ì„¸ìš”.
ê³±í•  ë•Œ ê° ì›ì†Œë¥¼ 1,000ìœ¼ë¡œ ë‚˜ëˆˆ ë‚˜ë¨¸ì§€ë¥¼ ì¶œë ¥í•´ì£¼ì„¸ìš”.

ğŸš¥ ë¬¸ì œì ‘ê·¼

í–‰ë ¬ì˜ ê³± bë§Œí¼ ê³±í•´ì¤ë‹ˆë‹¤. ì¦‰ bì˜ ì œê³±ì„ êµ¬í•˜ëŠ” ê²ë‹ˆë‹¤.

[í–‰ë ¬ ê³±ì…ˆ](https://www.acmicpc.net/problem/2740) ì„ í–‰ ë¬¸ì œ í’€ì´

í–‰ë ¬ ê³±ì…ˆì—ì„œ bë§Œí¼ ë” ëŒë¦¬ê¸°ì—”, bì˜ ìµœëŒ€ ê°’ì´ 10 x 10^11ì…ë‹ˆë‹¤. $O(N)$ë¼ê³  í•´ë„,
ë§¤ìš° ë§ì´ ì‹œê°„ ì´ˆê³¼ê°€
ë‚  ê±° ê°™ìŠµë‹ˆë‹¤. ë¶„í•  ì •ë³µ ê±°ë“­ì œê³±ì„ ì‚¬ìš©í•´ì„œ ì‹œê°„ ë³µì¡ë„ë¥¼ $O(log_2(N))$ìœ¼ë¡œ ì¤„ì…ë‹ˆë‹¤.

ë¶„í•  ì •ë³µ ê±°ë“œì œê³±ì˜ ê·œì¹™ì€ ì œê³±ì´ ì§ìˆ˜ì¼ ê²½ìš° í˜„ì¬ ê±°ë“­ì œê³±ì—ì„œ 2ë¡œ ë‚˜ëˆˆ ê°’ì„
ë‘ ë²ˆ ê³±í•©ë‹ˆë‹¤. í™€ìˆ˜ ì¼ ê²½ìš°, ë‘ë²ˆ ê³±í•œ ê°’ì—ì„œ ë³¸ë˜ ê°’ì„ í•œ ë²ˆ ë” ê³±í•´ì¤ë‹ˆë‹¤.

## 1ï¸âƒ£  ë¬¸ì œí’€ì´

1. ë©”íŠ¸ë¦­ìŠ¤(í–‰ì—´)ì„ ê³±í•©ë‹ˆë‹¤.

<style>
    .grid-containers {
        display: flex;
        gap: 30px;
        margin: 20px
    }
    .grid-container {
        display: grid;
        grid-template-rows: repeat(2, 100px);
        grid-template-columns: repeat(2, 100px);
        grid-auto-flow: column;
        gap: 5px;

   }
    .arrow-1 {
      width:100px;
      height:30px;
      display: flex;
      align-self: center;
    }

   .arrow-1:before {
      content: "";
      background: currentColor;
      width:15px;
      clip-path: polygon(0 10px,calc(100% - 15px) 10px,calc(100% - 15px) 0,100% 50%,calc(100% - 15px) 100%,calc(100% - 15px) calc(100% - 10px),0 calc(100% - 10px));
      animation: a1 1.5s infinite linear;
    }

    @keyframes a1 {
      90%,100%{flex-grow: 1}
    }

   .box {
       background-color: gray;
       border-radius: 5px;
       display: flex;
       justify-content: center;
       align-item: center;
       color: black;
   }

   .small-grid-containers {
       display: flex;
       margin: 10px;
   }
    
    .small-grid-container {
       display: grid;
       grid-template-rows: repeat(2, 50px);
       grid-template-columns: repeat(2, 50px);
       gap: 10px;
       margin: 10px
   }

   .small-box {
       display: flex;
        background-color: gray; 
        border-radius: 5px;
   }

   .small-box-x {
       background-color: red;
   }

    .small-box-y {
        background-color: blue;
    }
</style>

<div class="grid-containers">
    <div class="grid-container">
        <span class="box">a11</span>
        <div class="box">a21</div>
        <div class="box">a12</div>
        <div class="box">a22</div>
    </div>
    <div style="align-self: center">x</div>
    <div class="grid-container">
        <span class="box">b11</span>
        <div class="box">b21</div>
        <div class="box">b12</div>
        <div class="box">b22</div>
    </div>
    <div class="arrow-1"></div>
    <div class="grid-container">
        <span class="box">(a11 * b11) + (a12 * b21)</span>
        <div class="box">(a21 * b11) + (a22 * b 21)</div>
        <div class="box">(a11 * b12) + (a12 * b22)</div>
        <div class="box">(a21 * b12) + (a22 * b22)</div>
    </div>
</div>

<div class="small-grid-containers">
    <div class="small-grid-container">
        <div class="small-box-y"></div>
        <div class="small-box-x"></div>
        <div class="small-box-x"></div>
        <div class="small-box"></div>
    </div>
    <div class="arrow-1"></div>
    <div class="small-grid-container">
        <div class="small-box-x"></div>
        <div class="small-box-y"></div>
        <div class="small-box"></div>
        <div class="small-box-x"></div>
    </div>
    <div class="arrow-1"></div>
    <div class="small-grid-container">
        <div class="small-box-x"></div>
        <div class="small-box"></div>
        <div class="small-box-y"></div>
        <div class="small-box-x"></div>
    </div>
    <div class="arrow-1"></div>
    <div class="small-grid-container">
        <div class="small-box"></div>
        <div class="small-box-x"></div>
        <div class="small-box-x"></div>
        <div class="small-box-y"></div>
    </div>
</div>

2. ë¶„í•  ì •ë³µ ê±°ë“­ì œê³±ì„ ì‚¬ìš©í•˜ì—¬ í–‰ë ¬ ê³±ì…ˆì„ ë°˜ë³µí•œë‹¤.

```mermaid
flowchart TD

if_one{"if nì´ 1ì´ë©´"} 
if_one_t[/"í–‰ë ¬ ëŒë ¤ì£¼ê¸°"/]
divide_2["divided_two = í–‰ë ¬ì˜ n / 2 ìŠ¹"]
if_n_even{"if nì´ ì§ìˆ˜ë©´"}
if_n_even_t["í–‰ë ¬ì˜ n / 2ìŠ¹ì„ ê³±í•˜ê¸° 2"]
if_n_f["í–‰ë ¬ì˜ n / 2ìŠ¹ì„ ê³±í•˜ê¸° 2í•œ ë’¤ì— ì›ë˜ í–‰ë ¬ì„ ê³±í•´ì¤ë‹ˆë‹¤."]

if_one -- true --> if_one_t
if_one -- false --> divide_2
divide_2 --> if_n_even -- true --> if_n_even_t
if_n_even -- false --> if_n_f

```

### source code 

```c
#include<stdio.h>
#include<stdint.h>
#include<stdlib.h>

typedef struct {
    int32_t n;
    int32_t** m;
} Matrix;

void initial_matrix(Matrix* a) {
    a->m = (int32_t**)malloc(a->n * sizeof(int32_t*));

    for (int32_t i = 0; i < a->n; i += 1) {
        a->m[i] = (int32_t*)malloc(a->n * sizeof(int32_t));
    }
    return;
}

void input_matrix(Matrix* a) {
    for (int32_t i = 0; i < a->n; i += 1) {
        for (int32_t j = 0; j < a->n; j += 1) {
            scanf("%d", &a->m[i][j]);
        }
    }

    return;
}

void print_matrix(Matrix a) {
    for (int32_t i = 0; i < a.n; i += 1) {
        for (int32_t j = 0; j < a.n; j += 1) {
            printf("%d ", a.m[i][j]);
        }
        printf("\n");
    }
}

Matrix multiple_matrix(Matrix a, Matrix b) {
    Matrix c = { a.n };
	initial_matrix(&c);
	
    for (int32_t i = 0; i < a.n; i += 1) {
        for (int32_t j = 0; j < b.n; j += 1) {
            c.m[i][j] = 0;
            for (int32_t k = 0; k < b.n; k += 1) {
                c.m[i][j] = (c.m[i][j] % 1000) + (((a.m[i][k] % 1000) * (b.m[k][j] % 1000)) % 1000)
					% 1000;
            }
			c.m[i][j] %= 1000;
        }
    }

    return c;
}

Matrix powerof_matrix(int64_t exponent, Matrix a) {
    if (exponent <= 1) {
		for (int32_t i = 0; i < a.n; i += 1) {
			for (int32_t j = 0; j < a.n; j += 1) {
				a.m[i][j] %= 1000;
			}
		}

		return a;
    } 

    Matrix k = powerof_matrix(exponent / 2, a);

	Matrix s = multiple_matrix(k, k);
    if (exponent % 2 == 0) {
		return s;
    } else {
		return multiple_matrix(s, a);
    }
}


int32_t main(void) {
    int32_t n;
	int64_t b;
    scanf("%d %ld", &n, &b);
    Matrix a; 

    a.n = n;
    initial_matrix(&a);
    input_matrix(&a);
    a = powerof_matrix(b, a);
    print_matrix(a);
    return 0;
}
```
